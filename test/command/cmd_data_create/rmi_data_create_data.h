/*
 * Copyright (c) 2023, Arm Limited or its affiliates. All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#include "val_rmm.h"

enum test_intent {
    SRC_UNALIGNED = 0X0,
    SRC_DEV_MEM_MMIO = 0X1,
    SRC_OUTSIDE_OF_PERMITTED_PA = 0X2,
    SRC_PAS_REALM = 0X3,
    SRC_PAS_SECURE = 0X4,
    DATA_UNALIGNED = 0X5,
    DATA_DEV_MEM_MMIO = 0X6,
    DATA_OUTSIDE_OF_PERMITTED_PA = 0X7,
    DATA_STATE_UNDELEGATED = 0X8,
    DATA_STATE_RD = 0X9,
    DATA_STATE_REC = 0XA,
    DATA_STATE_RTT = 0XB,
    DATA_STATE_DATA = 0XC,
    DATA_PAS_SECURE = 0XD,
    RD_UNALIGNED = 0XE,
    RD_DEV_MEM_MMIO = 0XF,
    RD_OUTSIDE_OF_PERMITTED_PA = 0X10,
    RD_STATE_UNDELEGATED = 0X11,
    RD_STATE_DELEGATED = 0X12,
    RD_STATE_REC = 0X13,
    RD_STATE_RTT = 0X14,
    RD_STATE_DATA = 0X15,
    IPA_UNALIGNED = 0X16,
    IPA_UNPROTECTED = 0X17,
    IPA_OUTSIDE_OF_PERMITTED_IPA = 0X18,
    REALM_ACTIVE = 0X19,
    REALM_SYSTEM_OFF = 0X1A,
    REALM_NULL = 0X1B,
    IPA_NOT_MAPPED = 0X1C,
    RTTE_STATE_ASSIGNED = 0X1D,
    RIPAS_DESTROYED = 0X1E,
    RIPAS_EMPTY = 0X1F,
    IPA_UNPROTECTED_NOT_MAPPED = 0X20,
    IPA_UNPROTECTED_RTTE_ASSIGNED = 0X21
};

struct stimulus {
    char msg[100];
    uint64_t abi;
    enum test_intent label;
    uint64_t status;
    uint64_t index;
};

static struct stimulus test_data[] = {
    {.msg = "src_align",
    .abi = RMI_DATA_CREATE,
    .label = SRC_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "src_bound",
    .abi = RMI_DATA_CREATE,
    .label = SRC_DEV_MEM_MMIO,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "src_bound",
    .abi = RMI_DATA_CREATE,
    .label = SRC_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "src_pas",
    .abi = RMI_DATA_CREATE,
    .label = SRC_PAS_REALM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "src_pas",
    .abi = RMI_DATA_CREATE,
    .label = SRC_PAS_SECURE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_align",
    .abi = RMI_DATA_CREATE,
    .label = DATA_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_bound",
    .abi = RMI_DATA_CREATE,
    .label = DATA_DEV_MEM_MMIO,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_bound",
    .abi = RMI_DATA_CREATE,
    .label = DATA_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_state",
    .abi = RMI_DATA_CREATE,
    .label = DATA_STATE_UNDELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_state",
    .abi = RMI_DATA_CREATE,
    .label = DATA_STATE_RD,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_state",
    .abi = RMI_DATA_CREATE,
    .label = DATA_STATE_REC,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_state",
    .abi = RMI_DATA_CREATE,
    .label = DATA_STATE_RTT,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_state",
    .abi = RMI_DATA_CREATE,
    .label = DATA_STATE_DATA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "data_pas",
    .abi = RMI_DATA_CREATE,
    .label = DATA_PAS_SECURE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_align",
    .abi = RMI_DATA_CREATE,
    .label = RD_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_bound",
    .abi = RMI_DATA_CREATE,
    .label = RD_DEV_MEM_MMIO,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_bound",
    .abi = RMI_DATA_CREATE,
    .label = RD_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_DATA_CREATE,
    .label = RD_STATE_UNDELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_DATA_CREATE,
    .label = RD_STATE_DELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_DATA_CREATE,
    .label = RD_STATE_REC,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_DATA_CREATE,
    .label = RD_STATE_RTT,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_DATA_CREATE,
    .label = RD_STATE_DATA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "ipa_align",
    .abi = RMI_DATA_CREATE,
    .label = IPA_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "ipa_bound",
    .abi = RMI_DATA_CREATE,
    .label = IPA_UNPROTECTED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "ipa_bound",
    .abi = RMI_DATA_CREATE,
    .label = IPA_OUTSIDE_OF_PERMITTED_IPA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "realm_state",
    .abi = RMI_DATA_CREATE,
    .label = REALM_ACTIVE,
    .status = RMI_ERROR_REALM,
    .index = 0},
    {.msg = "realm_state",
    .abi = RMI_DATA_CREATE,
    .label = REALM_SYSTEM_OFF,
    .status = RMI_ERROR_REALM,
    .index = 0},
    {.msg = "realm_state_null",
    .abi = RMI_DATA_CREATE,
    .label = REALM_NULL,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rtt_walk",
    .abi = RMI_DATA_CREATE,
    .label = IPA_NOT_MAPPED,
    .status = RMI_ERROR_RTT,
    .index = 2},
    {.msg = "rtte_state",
    .abi = RMI_DATA_CREATE,
    .label = RTTE_STATE_ASSIGNED,
    .status = RMI_ERROR_RTT,
    .index = 3},
    {.msg = "rtte_ripas",
    .abi = RMI_DATA_CREATE,
    .label = RIPAS_DESTROYED,
    .status = RMI_ERROR_RTT,
    .index = 3},
    {.msg = "rtte_ripas",
    .abi = RMI_DATA_CREATE,
    .label = RIPAS_EMPTY,
    .status = RMI_ERROR_RTT,
    .index = 3},
    {.msg = "ipa_bound_compare_rtt_walk",
    .abi = RMI_DATA_CREATE,
    .label = IPA_UNPROTECTED_NOT_MAPPED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "ipa_bound_compare_rtte_state",
    .abi = RMI_DATA_CREATE,
    .label = IPA_UNPROTECTED_RTTE_ASSIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0}
};
