/*
 * Copyright (c) 2023, Arm Limited or its affiliates. All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#include "val_rmm.h"

enum test_intent {
    PARAMS_UNALIGNED = 0X0,
    PARAMS_DEV_MEM = 0X1,
    PARAMS_OUTSIDE_OF_PERMITTED_PA = 0X2,
    PARAMS_PAS_REALM = 0X3,
    PARAMS_PAS_SECURE = 0X4,
    HASH_ALGO_INVALID = 0X5,
    HASH_ALGO_UNSUPPORTED = 0X6,
    RTT_BASE_RD_ALIASED = 0X7,
    RD_UNALIGNED = 0X8,
    RD_DEV_MEM = 0X9,
    RD_OUTSIDE_OF_PERMITTED_PA = 0XA,
    RD_STATE_UNDELEGATED = 0XB,
    RD_STATE_RD = 0XC,
    RD_STATE_REC = 0XD,
    RD_STATE_RTT = 0XE,
    RD_STATE_DATA = 0XF,
    RTT_UNALIGNED = 0X10,
    FEAT_REG_INVALID = 0X11,
    RTT_START_INVALID = 0X12,
    RTT_BASE_UNDELEGATED = 0X13,
    VMID_INVALID = 0X14,
    VMID_USED = 0X15
};

struct stimulus {
    char msg[100];
    uint64_t abi;
    enum test_intent label;
    uint64_t status;
    uint64_t index;
};

static struct stimulus test_data[] = {
    {.msg = "params_align",
    .abi = RMI_REALM_CREATE,
    .label = PARAMS_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "params_bound",
    .abi = RMI_REALM_CREATE,
    .label = PARAMS_DEV_MEM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "params_bound",
    .abi = RMI_REALM_CREATE,
    .label = PARAMS_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "params_pas",
    .abi = RMI_REALM_CREATE,
    .label = PARAMS_PAS_REALM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "params_pas",
    .abi = RMI_REALM_CREATE,
    .label = PARAMS_PAS_SECURE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "hash_valid",
    .abi = RMI_REALM_CREATE,
    .label = HASH_ALGO_INVALID,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "hash_supp",
    .abi = RMI_REALM_CREATE,
    .label = HASH_ALGO_UNSUPPORTED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "alias",
    .abi = RMI_REALM_CREATE,
    .label = RTT_BASE_RD_ALIASED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_align",
    .abi = RMI_REALM_CREATE,
    .label = RD_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_bound",
    .abi = RMI_REALM_CREATE,
    .label = RD_DEV_MEM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_bound",
    .abi = RMI_REALM_CREATE,
    .label = RD_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_REALM_CREATE,
    .label = RD_STATE_UNDELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_REALM_CREATE,
    .label = RD_STATE_RD,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_REALM_CREATE,
    .label = RD_STATE_REC,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_REALM_CREATE,
    .label = RD_STATE_RTT,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rd_state",
    .abi = RMI_REALM_CREATE,
    .label = RD_STATE_DATA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rtt_align",
    .abi = RMI_REALM_CREATE,
    .label = RTT_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "feat_valid",
    .abi = RMI_REALM_CREATE,
    .label = FEAT_REG_INVALID,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rtt_num_level",
    .abi = RMI_REALM_CREATE,
    .label = RTT_START_INVALID,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rtt_state",
    .abi = RMI_REALM_CREATE,
    .label = RTT_BASE_UNDELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "vmid_valid",
    .abi = RMI_REALM_CREATE,
    .label = VMID_INVALID,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "vmid_valid",
    .abi = RMI_REALM_CREATE,
    .label = VMID_USED,
    .status = RMI_ERROR_INPUT,
    .index = 0}
};
