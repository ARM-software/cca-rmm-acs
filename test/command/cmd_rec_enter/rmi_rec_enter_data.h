/*
 * Copyright (c) 2023, Arm Limited or its affiliates. All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#include "val_rmm.h"

enum test_intent {
    RUN_PTR_UNALIGNED = 0X0,
    RUN_PTR_DEV_MEM = 0X1,
    RUN_PTR_OUSIDE_OF_PERMITTED_PA = 0X2,
    RUN_PTR_PAS_REALM = 0X3,
    RUN_PTR_PAS_SECURE = 0X4,
    REC_UNALIGNED = 0X5,
    REC_DEV_MEM = 0X6,
    REC_OUTSIDE_OF_PERMITTED_PA = 0X7,
    REC_GRAN_STATE_UNDELEGATED = 0X8,
    REC_GRAN_STATE_DELEGATED = 0X9,
    REC_GRAN_STATE_RD = 0XA,
    REC_GRAN_STATE_RTT = 0XB,
    REC_GRAN_STATE_DATA = 0XC,
    REC_GRAN_STATE_REC_AUX = 0XD,
    REALM_NEW = 0XE,
    REALM_SYSTEM_OFF = 0XF,
    REC_NOT_RUNNABLE = 0X10,
    REC_EMULATED_MMIO = 0X11,
    RUN_PTR_INVALID_GIV3_HCR = 0X12,
    REC_UNALIGNED_INVALID_GICV3 = 0X13,
    REC_DEV_MEM_INVALID_GICV3 = 0X14,
    REC_GRAN_STATE_UNDELEGATED_INVALID_GICV3 = 0X15,
    RUN_PAS_SECURE_REC_NOT_RUNNABLE = 0X16,
    RUN_PAS_SECURE_REALM_NEW = 0X17,
    RUN_PAS_SECURE_REALM_SYSTEM_OFF = 0X18,
    RUN_DEV_MEM_REC_NOT_RUNNABLE = 0X19,
    RUN_DEV_MEM_REALM_NEW = 0X1A,
    RUN_DEV_MEM_REALM_SYSTEM_OFF = 0X1B
};

struct stimulus {
    char msg[100];
    uint64_t abi;
    enum test_intent label;
    uint64_t status;
    uint64_t index;
};

static struct stimulus test_data[] = {
    {.msg = "run_align",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_bound",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_DEV_MEM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_bound",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_OUSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_pas",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_PAS_REALM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_pas",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_PAS_SECURE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_align",
    .abi = RMI_REC_ENTER,
    .label = REC_UNALIGNED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_bound",
    .abi = RMI_REC_ENTER,
    .label = REC_DEV_MEM,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_bound",
    .abi = RMI_REC_ENTER,
    .label = REC_OUTSIDE_OF_PERMITTED_PA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_UNDELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_DELEGATED,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_RD,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_RTT,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_DATA,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_REC_AUX,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "realm_new",
    .abi = RMI_REC_ENTER,
    .label = REALM_NEW,
    .status = RMI_ERROR_REALM,
    .index = 0},
    {.msg = "system_off",
    .abi = RMI_REC_ENTER,
    .label = REALM_SYSTEM_OFF,
    .status = RMI_ERROR_REALM,
    .index = 1},
    {.msg = "rec_runnable",
    .abi = RMI_REC_ENTER,
    .label = REC_NOT_RUNNABLE,
    .status = RMI_ERROR_REC,
    .index = 0},
    {.msg = "rec_mmio",
    .abi = RMI_REC_ENTER,
    .label = REC_EMULATED_MMIO,
    .status = RMI_ERROR_REC,
    .index = 0},
    {.msg = "rec_giv3",
    .abi = RMI_REC_ENTER,
    .label = RUN_PTR_INVALID_GIV3_HCR,
    .status = RMI_ERROR_REC,
    .index = 0},
    {.msg = "rec_align_compare_rec_gicv3",
    .abi = RMI_REC_ENTER,
    .label = REC_UNALIGNED_INVALID_GICV3,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_bound_compare_rec_gicv3",
    .abi = RMI_REC_ENTER,
    .label = REC_DEV_MEM_INVALID_GICV3,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "rec_gran_state_compare_rec_gicv3",
    .abi = RMI_REC_ENTER,
    .label = REC_GRAN_STATE_UNDELEGATED_INVALID_GICV3,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_pas_compare_rec_runnable",
    .abi = RMI_REC_ENTER,
    .label = RUN_PAS_SECURE_REC_NOT_RUNNABLE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_pas_compare_realm_new",
    .abi = RMI_REC_ENTER,
    .label = RUN_PAS_SECURE_REALM_NEW,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_pas_compare_system_off",
    .abi = RMI_REC_ENTER,
    .label = RUN_PAS_SECURE_REALM_SYSTEM_OFF,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_bound_compare_rec_runnable",
    .abi = RMI_REC_ENTER,
    .label = RUN_DEV_MEM_REC_NOT_RUNNABLE,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_bound_compare_realm_new",
    .abi = RMI_REC_ENTER,
    .label = RUN_DEV_MEM_REALM_NEW,
    .status = RMI_ERROR_INPUT,
    .index = 0},
    {.msg = "run_bound_compare_system_off",
    .abi = RMI_REC_ENTER,
    .label = RUN_DEV_MEM_REALM_SYSTEM_OFF,
    .status = RMI_ERROR_INPUT,
    .index = 0}
};
