# Arm RMM ACS Attestation and Measurement Testcase checklist
-------------------------------------------------------------------

This document presents the mapping of the rules in the RMM specification to the
test cases and the steps followed in the tests. This also provides the information
about the test coverage scenarios that are implemented in the current release of
ACS and the scenarios that are planned for the future releases.


| Test Number | Test Name     | Test Assertion                                                                                                                                                                                                                                                                                                                                                                                         | Test Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Validated By ACS |
| ---- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------- |
| 1    | measurement_immutable_rim         | RIM is immutable when realm changes from new to active                                                                                                                                                                                                                                                                                                                                           | 1\. Get the RIM after the realm got activated<br>2\. add and destroy the granules to the realm<br>3\. try getting the RIM <br>4\. both should be equal or else the test failsot activated                                                                                                                                                                                                                                                                                                                                                                                                                  | Yes               |
| 2    | measurement_rim_order         | RIM depends on the order of RMM operations executed during realm construction                                                                                                                                                                                                                                                                                                                    | 1\. construct realm A with as follows<br>2\. rd, rtt, ripas init, data create with exact image size. Before activating realm add one rec and one page.<br>3\. Repeat step 1. In step 2 first add data granule and than rec before activating the realm<br>4\. both RIM should be different, otherwise, the test fails<br><br>note:-<br><br>another variant of this scenario is as follows.<br><br>1\. create realm with different creation configurations like IPA size and protected ipa contents, <br>2\. observe the RIM and RIM should be different, otherwise test case fails                                                                                                    | Yes               |
| 3    | measurement_initial_rem_is_zero         |  The initial value of REM is 0                                                                                                                                                                                                                                                                                                                                                                   | 1\. activate realm<br>2\. content of RSI_MEASUREMENT_READ should return 0, otherwise, test fails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Yes               |
| 4    | attestation_token_init | Token init terminates an ongoing attestation generation operation                                                                                                                                                                                                                                                                                                                                | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT with challenge1. <br>3\. call RSI_ATTESTATION_TOKEN_INIT again with different challenge i.e. challenge2. <br>4\. call RSI_ATTESTATION_TOKEN_CONTINUE<br>5\. check the after token generation which should verify with challenge2.                                                                                                                                                                                                                                                                                                                                                                                                    | Yes               |
| 5    | attestation_challenge_data_verification | challenge data verification                                                                                                                                                                                                                                                                                                                                                                      | 1\. activate realm<br>2\. get the token and check the challenge value with the token challenge.<br> 3\. If challenge values are not same test fails.                                                                                                                                                                                                                                                                                                                                                                                                          | Yes               |
| 6    | attestation_token_address | Token address passed to INIT and CONTINUE command should be match                                                                                                                                                                                                                                                                            | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT with buffer pointer 1<br>3\. call RSI_ATTESTATION_TOKEN_CONTINUE with a buffer pointer different from INIT and check the returns error, if no error then the test fails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Yes               |
| 7    | attestation_rec_exit_irq | If a physical interrupt becomes pending during the execution of RSI_ATTESTATION_TOKEN_CONTINUE, a REC<br>exit due to IRQ can occur.<br><br>On the next entry to the REC:<br>• If a virtual interrupt is pending on that REC, it is taken to the REC’s exception handler<br>• RSI_ATTESTATION_TOKEN_CONTINUE returns RSI_INCOMPLETE<br>• The REC should call RSI_ATTESTATION_TOKEN_CONTINUE again | 1\. Register IRQ handler and enable IRQ interrupt. activate  realm<br>2\. Go to realm side. <br>3\. call RSI_ATTESTATION_TOKEN_INIT <br>4\. Go back to host side. <br>5\. Program and enable EL2 timer. and go to realm side. <br>6\. call  RSI_ATTESTATION_TOKEN_CONTINUE<br>7\. make sure that the timer triggers. <br>8\. check rec exit due to IRQ at host side.t<br>9\. If correct flags are set and interrut is triggered set the flag and go back to realm. <br>10\. check RSI_INCOMPLETE received for the call RSI_ATTESTATION_TOKEN_CONTINUE<br>11\. re-issue the call RSI_ATTESTATION_TOKEN_CONTINUE<br>12\. all above passes then the test passes else fails | Yes               |
| 8    | attestation_token_verify | verify the attestation token format                                                                                                                                                                                                                                                                                                                                                              | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT <br>3\. call RSI_ATTESTATION_TOKEN_CONTINUE<br>4\. check the token size within 4KB<br>5\. decode the CBOR-encoded token.<br>6\. verify the mandatory realm and platform token formats and claims are satisfied                                                                                                                                                                                                                                                                             | Yes               |
| 9    | attestation_rpv_value | verify RPV that's provided as input during realm creation is the same as that reported in the realm token                                                                                                                                                                                                                                                                                        | 1\.  create realm with RPV value and verify the RPVs reported in the realm token correspond to the supplied input rpv value during realm creation.                                                                                                                                                                                                                                                                                                                                                                                                                                       | Yes               |
| 10   | attestation_rem_extend_check<br>attestation_rem_extend_check_realm_token | REM Extend check                                                                                                                                                                                                                                                                                                                                                                                 |attestation_rem_extend_check:<br> 1\. Create and activate realm. <br>2\. Add known content through RSI_MEASUREMENT_EXTEND. Read the REM value through MEASUREMENT_READ.<br>3\. Compare REM values with zero and check REM values are not zero.<br>4\. If REM values are zero test failes else pass.<br>attestation_rem_extend_check_realm_token:<br>1\. Create and activate realm. <br>2\. Add known content through RSI_MEASUREMENT_EXTEND.<br>3\. Call RSI_TOKEN_INIT and CONTINUE and get token.<br>4\. Decode token and get REM value.<br>5\. Compare REM values with zero and check REM values are not zero.<br>6\. If REM values are zero test failes else pass.                                 | Yes               |
| 11   | attestation_realm_measurement_type | Realm measurement type ( cca-realm-measurement-type) should be either 32, 48, 64 byte                                                                                                                                                                                                                                                                                                            | 1\. activate realm<br>2\. get the measurement and check the measurement type size as mentioned                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Yes               |
| 12   | attestation_platform_challenge_size | platform attestation challenge size should be either 32, 48, 64                                                                                                                                                                                                                                                                                                                                  | 1\. activate realm<br>2\. get the attestation token  and check the size as mentioned                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Yes               |
