# Arm RMM ACS Attestation and Measurement Testcase checklist
-------------------------------------------------------------------

This document presents the mapping of the rules in the RMM specification to the
test cases and the steps followed in the tests. This also provides the information
about the test coverage scenarios that are implemented in the current release of
ACS and the scenarios that are planned for the future releases.


| S.No | Section     | Scenario                                                                                                                                                                                                                                                                                                                                                                                         | Test Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Validated By ACS |
| ---- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------- |
| 1    | RIM         | RIM is immutable when realm changes from new to active                                                                                                                                                                                                                                                                                                                                           | 1\. get the RIM after the realm g1. get the RIM after the realm got activated<br>2\. add and destroy the granules to the realm<br>3\. try getting the RIM <br>4\. both should be equal or else the test failsot activated                                                                                                                                                                                                                                                                                                                                                                                                                  | No               |
| 2    | RIM         | RIM depends on the order of RMM operations executed during realm construction                                                                                                                                                                                                                                                                                                                    | 1\. construct realm A with as follows<br>2\. rd, rtt, ripas init, data create with exact image size<br>3\. destroy the realm A<br>4\. repeat step 1 with 1/2 data granule extra before activating the realm<br>5\. both RIM should be different, otherwise, the test fails<br><br>note:-<br><br>another variant of this scenario is as follows.<br><br>1\. create realm with different creation configurations like IPA size and protected ipa contents, <br>2\. observe the RIM and RIM should be different, otherwise test case fails                                                                                                    | No               |
| 3    | REM         |  The initial value of REM is 0                                                                                                                                                                                                                                                                                                                                                                   | 1\. activate realm<br>2\. content of RSI_MEASUREMENT_READ should return 0, otherwise, test fails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | No               |
| 4    | ATTESTATION | Token init terminates an ongoing attestation generation operation                                                                                                                                                                                                                                                                                                                                | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT<br>3\. call RSI_ATTESTATION_TOKEN_CONTINUE<br>4\. call RSI_ATTESTATION_TOKEN_INIT again<br>5\. check the challenge to verify the ongoing token generation has been canceled                                                                                                                                                                                                                                                                                                                                                                                                      | No               |
| 5    | ATTESTATION | challenge data verification                                                                                                                                                                                                                                                                                                                                                                      | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT with buffer pointer 1<br>3\. call RSI_ATTESTATION_TOKEN_CONTINUE with a buffer pointer different from INIT and check the returns error, if no error then the test fails                                                                                                                                                                                                                                                                                                                                                                                                          | No               |
| 6    | ATTESTATION | verify attestation token remains the same for back-to-back attestation token continue ops with 2 different challenges                                                                                                                                                                                                                                                                            | 1\. Activate realm<br>2\. two back-to-back attestation tokens should result in the same, if not then the test fails                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | No               |
| 7    | ATTESTATION | If a physical interrupt becomes pending during the execution of RSI_ATTESTATION_TOKEN_CONTINUE, a REC<br>exit due to IRQ can occur.<br><br>On the next entry to the REC:<br>• If a virtual interrupt is pending on that REC, it is taken to the REC’s exception handler<br>• RSI_ATTESTATION_TOKEN_CONTINUE returns RSI_INCOMPLETE<br>• The REC should call RSI_ATTESTATION_TOKEN_CONTINUE again | 1\. activate  realm<br>2\. program watchdog on the realm<br>3\. start watchdog<br>4\. call RSI_ATTESTATION_TOKEN_INIT <br>5\. call call RSI_ATTESTATION_TOKEN_CONTINUE<br>6\. make sure that the watchdog interrupt fires <br>7\. check rec exit due to IRQ at host side and host  issues the rec enter with GIC register set for RMM to inject the virtual interrupt<br>8\. check the realm exception handler called for the interrupt<br>9\. check RSI_INCOMPLETE received for the call RSI_ATTESTATION_TOKEN_CONTINUE<br>10\. re-issue the call RSI_ATTESTATION_TOKEN_CONTINUE<br>11\. all above passes then the test passes else fails | No               |
| 8    | ATTESTATION | verify the attestation token format                                                                                                                                                                                                                                                                                                                                                              | 1\. activate realm<br>2\. call RSI_ATTESTATION_TOKEN_INIT <br>3\. call call RSI_ATTESTATION_TOKEN_CONTINUE<br>4\. check the token size within 4KB<br>5\. decode the CBOR-encoded token<br>6\. check the realm token public key and platform token challenge correlation.<br>7\. verify the mandatory realm and platform token formats and claims are satisfied                                                                                                                                                                                                                                                                             | No               |
| 9    | ATTESTATION | verify RPV that's provided as input during realm creation is the same as that reported in the realm token                                                                                                                                                                                                                                                                                        | 1\.  create two realms with different RPVs and verify the RPVs reported in the realm token correspond to the supplied input values and that the realm token barring this field must be identical (?)                                                                                                                                                                                                                                                                                                                                                                                                                                       | No               |
| 10   | ATTESTATION | REM Extend check                                                                                                                                                                                                                                                                                                                                                                                 | 1\. start with an initial RIM. Add known content through RSI_MEASUREMENT_EXTEND. Read the REM value through MEASUREMENT_READ.<br>2\. Repeat the above step for a different REM (different index) with identical content.<br>3\. Verify REM in [1] and [2] are identical.<br><br>Note:-<br><br>the algo to calculate REM is architected. If yes, in each of the above steps, we can read computed REM and calculate expected REM (need a related library like SHA 512 or whatever is architected algo to compute expected hash) and compare them.                                                                                           | No               |
| 11   | ATTESTATION | Realm measurement type ( cca-realm-measurement-type) should be either 32, 48, 64 byte                                                                                                                                                                                                                                                                                                            | 1\. activate realm<br>2\. get the measurement and check the measurement type size as mentioned                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | No               |
| 12   | ATTESTATION | platform attestation challenge size should be either 32, 48, 64                                                                                                                                                                                                                                                                                                                                  | 1\. activate realm<br>2\. get the attestation token  and check the size as mentioned                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | No               |
