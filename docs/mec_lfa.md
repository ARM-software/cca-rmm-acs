# Arm RMM ACS MEC and LFA Testcase checklist
-----------------------------------------------------

This document presents the mapping of the rules in the RMM specification to the
test cases and the steps followed in the tests. This also provides the information
about the test coverage scenarios that are implemented in the current release of
ACS and the scenarios that are planned for the future releases.


| Test Number | Test Name             | Test Assertion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Test Steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Validated by ACS |
| ----------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| 1           | cmd_realm_create | The highest MECID value which the Host is permitted to pass via an RMI command is reported by the RMI_FEATURES command in  RmiFeatureRegister1::MAX_MECID.A valid MECID is a MECID in the range [0, MAX_MECID].  | 1. Read the RMI_FEATURES index 1.<br>2. Pass (MAX_MECID + 1) for REALM_CREATE and check for error status code.<br>Validated part of realm_create command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 2           | mec_feat_support | On a platform which does not implement FEAT_MEC, MAX_MECID is zero.  | 1. Read the FEAT_MEC and if it's not supported check for MAX_MECID zero. <br>2. If FEAT_MEC is supported, skip the test case.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 3           | mec_id_private |MEC_POLICY_PRIVATE: The MEC protects memory owned by a single Realm. A MEC with this policy may be referred to as a Private MEC.   | 1. Create relam using RMI_REALM_CREATE(rd=a, mecid=1) command and activate the realm.<br>2. Invoke REC_ENTER command, enter the realm and execute the instructions.<br>3. Destroy the realm <br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 4           | mec_id_shared | MEC_POLICY_SHARED: The MEC protects memory owned by multiple Realms. A MEC with this policy may be referred to as a Shared MEC.  |1. Invoke RMI_MEC_SET_SHARED (mecid=1) command and changes the state of a MEC from MEC_STATE_PRIVATE_UNASSIGNED to  MEC_STATE_SHARED.<br>2. Create two relams using RMI_REALM_CREATE(mecid=1) command and activate the realm.<br>3. Invoke REC_ENTER command, enter the realm and execute the instructions.<br>4. Destroy the realm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Yes              |
| 5           | mec_private_shared |At platform boot, the state of every MEC in the range [0, MAX_MECID] is MEC_STATE_PRIVATE_UNASSIGNED.<br>Assign a Private MEC to each Realm, with the total number of Realms not exceeding MAX_MECID.<br>Use the Shared MEC for some Realms; for the remaining Realms, assign a Private MEC to each, with the total number of this latter set of Realms not exceeding MAX_MECID.   | 1. Invoke RMI_MEC_SET_SHARED (mecid=1) command and create two relams using RMI_REALM_CREATE(rd=a, mecid=1) command and activate the realm.<br>2. Create two relams using RMI_REALM_CREATE(mecid=2, mecid=3) command and activate the realm.<br>3. Invoke REC_ENTER command, enter the realm and execute the instructions.<br>4. Destroy the realm                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Yes              |
| 6           | cmd_realm_create | RMI_REALM_CREATE fails if any of the following is true:<br>• The MECID is not valid.<br>• The state of the MEC is MEC_STATE_PRIVATE_ASSIGNED.  | <br>Validated part of realm_create command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 7           | cmd_realm_create | On successful execution of RMI_REALM_CREATE:<br>• If the state of the MEC is MEC_STATE_PRIVATE_UNASSIGNED then the state becomes MEC_STATE_PRIVATE_ASSIGNED.<br>• If the state of the MEC is MEC_STATE_SHARED then the new Realm is added to the Shared MEC.  | <br>Validated part of realm_create command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 8           | cmd_mec_set_shared |Execution of RMI_MEC_SET_SHARED fails if any of the following is true:<br>• The MECID provided by the Host is not valid.<br>• The MECID provided by the Host identifies a MEC whose current state is not MEC_STATE_PRIVATE_UNASSIGNED.<br>• Any valid MECID identifies a Shared MEC. This means that there can be at most a single Shared MEC in existence at a time   | <br>Validated part of RMI_MEC_SET_SHARED command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 9           | cmd_mec_set_private | Execution of RMI_MEC_SET_PRIVATE fails if any of the following is true:<br>• MAX_MECID is zero.<br>• The MECID provided by the Host is not valid.<br>• The MECID provided by the Host identifies a MEC whose current state is not MEC_STATE_SHARED.<br>• The MECID provided by the Host identifies a Shared MEC which contains a non-zero number of Realms.  | <br>Validated part of RMI_MEC_SET_PRIVATE command.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
| 10           | lfa_test | To apply LFA to RMM from the host, it must fail during the preparation stage in LFA PRIME.  | 1. Query the LFA version and check for the expected LFA major and minor version.<br>2. Invoke LFA_GET_INFO with lfa_info_selector=0.check for the total number of LFA components.<br>3. Invoke the LFA_GET_INVENTORY for all LFA components and check to find the RMM firmware sequence id.<br>4. Invoke the LFA_PRIME and provide the RMM firmware sequence id. Check for the LFA_WRONG_STATE error code.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Yes              |
